import React, { useEffect, useRef } from 'react';
import ApexCharts from 'apexcharts';

const ChartApex = ({ levels, totalValues }) => {
  const chartRef = useRef(null);

  useEffect(() => {
    const chartData = {
      series: [
        {
          data: totalValues, // Matches data values with the chart
        },
      ],
      chart: {
        type: 'bar',
        height: 400,
        toolbar: { show: false },
        animations: {
          enabled: true,
          easing: 'easeinout',
          speed: 1000,
        },
      },
      plotOptions: {
        bar: {
          horizontal: true,
          borderRadius: 10, // Soft rounded edges for a modern look
          barHeight: '50%', // Slimmer bar height for a clean look
          distributed: true, // Colors bars individually
        },
      },
      colors:  ['#E53935','#FB8C00', '#FFCA28', '#66BB6A','#B0BEC5'], // Keep the palette but make it more cohesive
      dataLabels: {
        enabled: true,
        offsetX: 10, // Adjust to give more room for the labels
        style: {
          colors: ['#fff'], // White labels for contrast
          fontSize: '16px', // Slightly larger font size for better readability
          fontWeight: '500', // Slightly lighter weight for a modern feel
          fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif", // Use modern, sans-serif font
        },
        background: {
          color:'black',
          borderRadius: 5,
          padding: 6,
          opacity: 0.9,
        },
        position: 'right', // Data labels aligned to the right end of the bar
        formatter: (value) => `${value}`,
      },
      xaxis: {
        categories: Object.keys(levels),
        labels: {
          style: {
            colors: '#888', // Lighter color for x-axis labels for a modern look
            fontSize: '14px',
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          },
        },
      },
      yaxis: {
        labels: {
          style: {
            colors: '#333', // Darker color for y-axis labels
            fontSize: '14px',
            fontWeight: '600',
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          },
        },
      },
      grid: {
        borderColor: '#e0e0e0',
        strokeDashArray: 3, // Subtle dashed grid lines for a modern feel
      },
      tooltip: {
        theme: 'dark',
        x: { show: true },
        y: {
          formatter: (value) => `${value}%`,
          title: { formatter: () => 'Level' },
        },
      },
      legend: {
        show: false, // Hide legend for a cleaner look
      },
      responsive: [
        {
          breakpoint: 768, // Make the chart more responsive on smaller screens
          options: {
            chart: {
              height: 300, // Adjust chart height on smaller screens
            },
            dataLabels: {
              style: {
                fontSize: '12px', // Adjust font size on smaller screens
              },
            },
          },
        },
      ],
    };

    const chart = new ApexCharts(chartRef.current, chartData);
    chart.render();

    // Cleanup chart instance on unmount
    return () => chart.destroy();
  }, [levels, totalValues]);

  return <div ref={chartRef} />;
};

export default ChartApex;
